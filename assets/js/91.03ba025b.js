(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{531:function(e,t,s){"use strict";s.r(t);var n=s(1),o=Object(n.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"events"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#events"}},[e._v("#")]),e._v(" Events")]),e._v(" "),t("p",{attrs:{synopsis:""}},[t("code",[e._v("Event")]),e._v("s are objects that contain information about the execution of the application. They are\nmainly used by service providers like block explorers and wallet to track the execution of various\nmessages and index transactions.")]),e._v(" "),t("h2",{attrs:{id:"pre-requisite-readings"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pre-requisite-readings"}},[e._v("#")]),e._v(" Pre-requisite Readings")]),e._v(" "),t("ul",[t("li",{attrs:{prereq:""}},[t("a",{attrs:{href:"https://docs.cosmos.network/main/core/events.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Cosmos SDK Events"),t("OutboundLink")],1)]),e._v(" "),t("li",{attrs:{prereq:""}},[t("a",{attrs:{href:"https://geth.ethereum.org/docs/rpc/pubsub",target:"_blank",rel:"noopener noreferrer"}},[e._v("Ethereum's PubSub JSON-RPC API"),t("OutboundLink")],1)])]),e._v(" "),t("h2",{attrs:{id:"subscribing-to-events"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#subscribing-to-events"}},[e._v("#")]),e._v(" Subscribing to Events")]),e._v(" "),t("h3",{attrs:{id:"cosmos-and-tendermint-events"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cosmos-and-tendermint-events"}},[e._v("#")]),e._v(" Cosmos and Tendermint Events")]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",[e._v("Check the "),t("RouterLink",{attrs:{to:"/developers/clients.html#tendermint-websocket"}},[e._v("Tendermint Websocket")]),e._v(" in the Clients documentation for reference.")],1)]),e._v(" "),t("p",[e._v("It is possible to subscribe to "),t("code",[e._v("Events")]),e._v(" via Tendermint's "),t("a",{attrs:{href:"https://docs.tendermint.com/v0.34/tendermint-core/subscription.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Websocket"),t("OutboundLink")],1),e._v(".\nThis is done by calling the "),t("code",[e._v("subscribe")]),e._v(" RPC method via Websocket:")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"ewogICAgJnF1b3Q7anNvbnJwYyZxdW90OzogJnF1b3Q7Mi4wJnF1b3Q7LAogICAgJnF1b3Q7bWV0aG9kJnF1b3Q7OiAmcXVvdDtzdWJzY3JpYmUmcXVvdDssCiAgICAmcXVvdDtpZCZxdW90OzogJnF1b3Q7MCZxdW90OywKICAgICZxdW90O3BhcmFtcyZxdW90OzogewogICAgICAgICZxdW90O3F1ZXJ5JnF1b3Q7OiAmcXVvdDt0bS5ldmVudD0nJmx0O2V2ZW50X3ZhbHVlJmd0OycgQU5EIGV2ZW50VHlwZS5ldmVudEF0dHJpYnV0ZT0nJmx0O2F0dHJpYnV0ZV92YWx1ZSZndDsnJnF1b3Q7CiAgICB9Cn0K"}}),e._v(" "),t("p",[e._v("These events are triggered after a block is committed. You can get the full list of "),t("code",[e._v("event")]),e._v(" categories and values "),t("RouterLink",{attrs:{to:"/developers/clients.html#list-of-tendermint-events"}},[e._v("here")]),e._v(".")],1),e._v(" "),t("p",[e._v("The "),t("code",[e._v("type")]),e._v(" and "),t("code",[e._v("attribute")]),e._v(" value of the "),t("code",[e._v("query")]),e._v(" allow you to filter the specific "),t("code",[e._v("event")]),e._v(" you are\nlooking for. For example, a an Ethereum transaction on Planq ("),t("code",[e._v("MsgEthereumTx")]),e._v(") triggers an "),t("code",[e._v("event")]),e._v(" of type "),t("code",[e._v("ethermint")]),e._v(" and\nhas "),t("code",[e._v("sender")]),e._v(" and "),t("code",[e._v("recipient")]),e._v(" as "),t("code",[e._v("attributes")]),e._v(". Subscribing to this "),t("code",[e._v("event")]),e._v(" would be done like so:")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"ewogICAgJnF1b3Q7anNvbnJwYyZxdW90OzogJnF1b3Q7Mi4wJnF1b3Q7LAogICAgJnF1b3Q7bWV0aG9kJnF1b3Q7OiAmcXVvdDtzdWJzY3JpYmUmcXVvdDssCiAgICAmcXVvdDtpZCZxdW90OzogJnF1b3Q7MCZxdW90OywKICAgICZxdW90O3BhcmFtcyZxdW90OzogewogICAgICAgICZxdW90O3F1ZXJ5JnF1b3Q7OiAmcXVvdDt0bS5ldmVudD0nVHgnIEFORCBldGhlcmV1bS5yZWNpcGllbnQ9J2hleEFkZHJlc3MnJnF1b3Q7CiAgICB9Cn0K"}}),e._v(" "),t("p",[e._v("where "),t("code",[e._v("hexAddress")]),e._v(" is an Ethereum hex address (eg: "),t("code",[e._v("0x1122334455667788990011223344556677889900")]),e._v(").")]),e._v(" "),t("h3",{attrs:{id:"ethereum-events"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ethereum-events"}},[e._v("#")]),e._v(" Ethereum Events")]),e._v(" "),t("p",[e._v("Planq also supports the Ethereum "),t("RouterLink",{attrs:{to:"/developers/json-rpc/server.html"}},[e._v("JSON-RPC")]),e._v(" filters calls to\nsubscribe to "),t("a",{attrs:{href:"https://eth.wiki/json-rpc/API#eth_newfilter",target:"_blank",rel:"noopener noreferrer"}},[e._v("state logs"),t("OutboundLink")],1),e._v(",\n"),t("a",{attrs:{href:"https://eth.wiki/json-rpc/API#eth_newblockfilter",target:"_blank",rel:"noopener noreferrer"}},[e._v("blocks"),t("OutboundLink")],1),e._v(" or "),t("a",{attrs:{href:"https://eth.wiki/json-rpc/API#eth_newpendingtransactionfilter",target:"_blank",rel:"noopener noreferrer"}},[e._v("pending transactions"),t("OutboundLink")],1),e._v(" changes.")],1),e._v(" "),t("p",[e._v("Under the hood, it uses the Tendermint RPC client's event system to process subscriptions that are\nthen formatted to Ethereum-compatible events.")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"Y3VybCAtWCBQT1NUIC0tZGF0YSAneyZxdW90O2pzb25ycGMmcXVvdDs6JnF1b3Q7Mi4wJnF1b3Q7LCZxdW90O21ldGhvZCZxdW90OzomcXVvdDtldGhfbmV3QmxvY2tGaWx0ZXImcXVvdDssJnF1b3Q7cGFyYW1zJnF1b3Q7OltdLCZxdW90O2lkJnF1b3Q7OjF9JyAtSCAmcXVvdDtDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24mcXVvdDsgaHR0cDovL2xvY2FsaG9zdDo4NTQ1Cgp7JnF1b3Q7anNvbnJwYyZxdW90OzomcXVvdDsyLjAmcXVvdDssJnF1b3Q7aWQmcXVvdDs6MSwmcXVvdDtyZXN1bHQmcXVvdDs6JnF1b3Q7MHgzNTAzZGU1ZjBjNzY2YzY4Zjc4YTAzYTNiMDUwMzZhNSZxdW90O30K"}}),e._v(" "),t("p",[e._v("Then you can check if the state changes with the "),t("a",{attrs:{href:"https://eth.wiki/json-rpc/API#eth_getfilterchanges",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("eth_getFilterChanges")]),t("OutboundLink")],1),e._v(" call:")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"Y3VybCAtWCBQT1NUIC0tZGF0YSAneyZxdW90O2pzb25ycGMmcXVvdDs6JnF1b3Q7Mi4wJnF1b3Q7LCZxdW90O21ldGhvZCZxdW90OzomcXVvdDtldGhfZ2V0RmlsdGVyQ2hhbmdlcyZxdW90OywmcXVvdDtwYXJhbXMmcXVvdDs6WyZxdW90OzB4MzUwM2RlNWYwYzc2NmM2OGY3OGEwM2EzYjA1MDM2YTUmcXVvdDtdLCZxdW90O2lkJnF1b3Q7OjF9JyAtSCAmcXVvdDtDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24mcXVvdDsgaHR0cDovL2xvY2FsaG9zdDo4NTQ1Cgp7JnF1b3Q7anNvbnJwYyZxdW90OzomcXVvdDsyLjAmcXVvdDssJnF1b3Q7aWQmcXVvdDs6MSwmcXVvdDtyZXN1bHQmcXVvdDs6WyZxdW90OzB4N2Q0NGRjZWZmMDVkNTk2M2I1YmM4MWRmN2U5Zjc5YjI3ZTc3N2IwYTAzYTZmZWNhMDlmMzQ0N2I5OWM2ZmE3MSZxdW90OywmcXVvdDsweDM5NjFlNDA1MGMyN2NlMDE0NWQzNzUyNTViM2NiODI5YTViNGU3OTVhYzQ3NWMwNWEyMTliMzczMzcyM2QzNzYmcXVvdDssJnF1b3Q7MHhkN2E0OTdmOTUxNjdkNjNlNmZlY2E3MGYzNDRkOWY2ZTg0M2QwOTdiNjI3MjliOGY0M2JkY2Q1ZmViZjE0MmFiJnF1b3Q7LCZxdW90OzB4NTVkODBhNGJhNmVmNTRmMmE4YzBiOTk1ODlkMDE3YjgxMGVkMTNhMWZkYTZhMTExZTFiODc3MjViYzhjZWIwZSZxdW90OywmcXVvdDsweDllOGI5MmMxNzI4MGRkMDVmMjU2MmFmNmVlYTMyODUxODFjNTYyZWJmNDFmYzc1ODUyN2Q0YzMwMzY0YmNiYzQmcXVvdDssJnF1b3Q7MHg3MzUzYTRiOWQ2YjM1YzllYWZlY2NhZjk3MjJkZDI5M2M0NmFlMmZmZDQwOTNiMjM2NzE2NWMzNjIwYTBjN2M5JnF1b3Q7LCZxdW90OzB4MDI2ZDkxYmRhNjFjODc4OWM1OTYzMmMzNDliMzhmZDdlNzU1N2U2YjU5OGI5NDg3OTY1NGE2NDRjZmE3NWYzMCZxdW90OywmcXVvdDsweDczZTMyNDVkNGRkYzNiYmE0OGZhNjc2MzNmOTk5M2M2ZTExNzI4YTM2NDAxZmExMjA2NDM3ZjhiZTk0ZWYxZDMmcXVvdDtdfQo="}}),e._v(" "),t("h2",{attrs:{id:"websocket-connection"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#websocket-connection"}},[e._v("#")]),e._v(" Websocket Connection")]),e._v(" "),t("h3",{attrs:{id:"tendermint-websocket"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tendermint-websocket"}},[e._v("#")]),e._v(" Tendermint Websocket")]),e._v(" "),t("p",[e._v("To start a connection with the Tendermint websocket you need to define the address with the "),t("code",[e._v("--rpc.laddr")]),e._v("\nflag when starting the node (default "),t("code",[e._v("tcp://127.0.0.1:26657")]),e._v("):")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"cGxhbnFkIHN0YXJ0IC0tcnBjLmxhZGRyPSZxdW90O3RjcDovLzEyNy4wLjAuMToyNjY1NyZxdW90Owo="}}),e._v(" "),t("p",[e._v("Then, start a websocket subscription with "),t("a",{attrs:{href:"https://github.com/hashrocket/ws",target:"_blank",rel:"noopener noreferrer"}},[e._v("ws"),t("OutboundLink")],1)]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"IyBjb25uZWN0IHRvIHRlbmRlcm1pbnQgd2Vic29ja2V0IGF0IHBvcnQgODA4MCBhcyBkZWZpbmVkIGFib3ZlCndzIHdzOi8vbG9jYWxob3N0OjgwODAvd2Vic29ja2V0CgojIHN1YnNjcmliZSB0byBuZXcgVGVuZGVybWludCBibG9jayBoZWFkZXJzCiZndDsgeyAmcXVvdDtqc29ucnBjJnF1b3Q7OiAmcXVvdDsyLjAmcXVvdDssICZxdW90O21ldGhvZCZxdW90OzogJnF1b3Q7c3Vic2NyaWJlJnF1b3Q7LCAmcXVvdDtwYXJhbXMmcXVvdDs6IFsmcXVvdDt0bS5ldmVudD0nTmV3QmxvY2tIZWFkZXInJnF1b3Q7XSwgJnF1b3Q7aWQmcXVvdDs6IDEgfQo="}}),e._v(" "),t("h3",{attrs:{id:"ethereum-websocket"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ethereum-websocket"}},[e._v("#")]),e._v(" Ethereum Websocket")]),e._v(" "),t("p",[e._v("Since Planq runs uses Tendermint Core as it's consensus Engine and it's built with the Cosmos\nSDK framework, it inherits the event format from them. However, in order to support the native Web3\ncompatibility for websockets of the "),t("a",{attrs:{href:"https://geth.ethereum.org/docs/rpc/pubsub",target:"_blank",rel:"noopener noreferrer"}},[e._v("Ethereum's PubSubAPI"),t("OutboundLink")],1),e._v(", Planq needs to cast the Tendermint\nresponses retrieved into the Ethereum types.")]),e._v(" "),t("p",[e._v("You can start a connection with the Ethereum websocket using the "),t("code",[e._v("--json-rpc.ws-address")]),e._v(" flag when starting\nthe node (default "),t("code",[e._v('"0.0.0.0:8546"')]),e._v("):")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"cGxhbnFkIHN0YXJ0ICAtLWpzb24tcnBjLmFkZHJlc3MmcXVvdDswLjAuMC4wOjg1NDUmcXVvdDsgLS1qc29uLXJwYy53cy1hZGRyZXNzPSZxdW90OzAuMC4wLjA6ODU0NiZxdW90OyAtLWV2bS5ycGMuYXBpPSZxdW90O2V0aCx3ZWIzLG5ldCx0eHBvb2wsZGVidWcmcXVvdDsgLS1qc29uLXJwYy5lbmFibGUK"}}),e._v(" "),t("p",[e._v("Then, start a websocket subscription with "),t("a",{attrs:{href:"https://github.com/hashrocket/ws",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("ws")]),t("OutboundLink")],1)]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"IyBjb25uZWN0IHRvIHRlbmRlcm1pbnQgd2Vic29jZXQgYXQgcG9ydCA4NTQ2IGFzIGRlZmluZWQgYWJvdmUKd3Mgd3M6Ly9sb2NhbGhvc3Q6ODU0Ni8KCiMgc3Vic2NyaWJlIHRvIG5ldyBFdGhlcmV1bS1mb3JtYXR0ZWQgYmxvY2sgSGVhZGVycwomZ3Q7IHsmcXVvdDtpZCZxdW90OzogMSwgJnF1b3Q7bWV0aG9kJnF1b3Q7OiAmcXVvdDtldGhfc3Vic2NyaWJlJnF1b3Q7LCAmcXVvdDtwYXJhbXMmcXVvdDs6IFsmcXVvdDtuZXdIZWFkcyZxdW90Oywge31dfQombHQ7IHsmcXVvdDtqc29ucnBjJnF1b3Q7OiZxdW90OzIuMCZxdW90OywmcXVvdDtyZXN1bHQmcXVvdDs6JnF1b3Q7MHg0NGUwMTBjYjJjMzE2MWU5YzAyMjA3ZmYxNzIxNjZlZiZxdW90OywmcXVvdDtpZCZxdW90OzoxfQo="}})],1)}),[],!1,null,null,null);t.default=o.exports}}]);